<!--pages/shareCard/myCardDesc/myCardDesc.wxml-->
<view class="containerBox">
    <view class="shopInfo flexStart">
        <image class="logo" src="{{cardDesc.logo}}"></image>
        <text class="brand">{{cardDesc.name}}</text>
    </view>
    <!-- 卡 -->
    <view class="cardBox">
        <image class="fuCard" wx:if="{{cardDesc.subject=='2000'}}"
            src="https://saler.ishangbin.com/img/shareCard/fuCard.png"> </image>
        <image class="mainCard" wx:else src="https://saler.ishangbin.com/img/shareCard/mainCard.png"></image>

        <view class="cardTopInfo">
            <view class="rightBox flexEnd" bindtap="seeCardDetail">
                <view class="seeDetail flexCenter">
                    <view class="date">{{cardDesc.card.endTime}}到期</view>
                    <image class="cardDetailIcon" src="https://saler.ishangbin.com/img/shareCard/erweimaIcon.png">
                    </image>
                </view>
            </view>
            <!-- 进度 start-->
            <view class="cardProcessBox flexSpace" wx:if="{{cardDesc.card}}">
                <view class="textBox flexSpace" wx:if="{{cardDesc.card.amount}}">
                    当前<text class="discountNum">{{cardDesc.card.amount}}</text>折
                </view>
                <view class="lineBox">
                    <view class="bgLine"></view>
                    <view class="acLine"
                        style="width:{{(cardDesc.card.orgAmount-cardDesc.card.amount)/(cardDesc.card.orgAmount-cardDesc.card.limit)}}%">
                    </view>
                    <view class="locateBox flexCenter"
                        style="left:{{(cardDesc.card.orgAmount-cardDesc.card.amount)/(cardDesc.card.orgAmount-cardDesc.card.limit)}}%">
                        <image class="locate" src="https://saler.ishangbin.com/img/shareCard/huojian.png"></image>
                        <!-- <view class="nowDiscount">当前{{cardDesc.card.amount}}折</view> -->
                    </view>
                </view>
                <view class="textBox" wx:if="{{cardDesc.card.limit}}">
                    最低<text class="discountNum">{{cardDesc.card.limit}}</text>折
                </view>
            </view>
            <!-- 进度条end  -->
            <view class="name">
                {{cardDesc.card.name}}
            </view>
        </view>

        <div class="couponBox flexStart">
            <!-- 查看券 -->
            <view class="couponNav flexSpace" bindtap="toCoupon">
                 <view class="leftText">  <text class="couponCount">{{cardDesc.couponCount||0}}</text>
                    张自用券</view> 
                    <view class="tag tag1">
                        <text class="text">可用</text>
                    </view>
            </view>
            <view class="couponNav flexSpace" bindtap="toCoupon"
                wx:if="{{cardDesc.couponShareCount&&cardDesc.couponShareCount>0}}">
                    <view class="leftText"> <text class="couponCount">{{cardDesc.couponShareCount||0}}</text>
                        张分享券</view>
                    <view class="tag"><text class="text">分享</text></view>
            </view>
        </div>

    </view>
    <!-- 通知start -->
    <view class="cardInfo flexStart" wx:if="{{cardDesc.latestActivateDate}}">
        <image class="tongzhi" src="https://saler.ishangbin.com/img/shareCard/tongzhi.png"></image>
        <text>{{cardDesc.latestActivateDate}}之前未到此卡的适用门店消费，此卡自动失效。</text>
    </view>
    <!-- 通知start -->

    <!-- 邀请 -->
    <view class="parterBox">
        <view class="title flexSpace">
            <view class="leftTips">当前{{cardDesc.shares.joined}}人共享</view>
            <button wx:if="{{cardDesc.shares.remained>0}}" open-type="share" class="toInvide">立即邀请</button>
            <button wx:else class="toInvide  fulldata">共享名额已满</button>
        </view>
        <view class="parter  {{cardDesc.shares.remained+cardDesc.shares.users.length>=5?'flexSpace':'flexStart'}}">
            <view class="eachParter" wx:for="{{cardDesc.shares.users}}" wx:key="index">
                <image class="parterImg" src="{{item.avatarUrl}}"></image>
                <view class="name">{{item.nickname}}</view>
            </view>
            <view class="eachParter" wx:for="{{cardDesc.shares.remained}}" wx:key="index">
                <image class="parterImg" src="https://saler.ishangbin.com/img/shareCard/notInvide.png"></image>
                <view class="name">待邀请</view>
            </view>
        </view>
    </view>

    <!-- 权益升级规则 -->
    <view class="contentContainer">
        <view class="content">
            <!-- 权益升级规则 -->
            <view class="rightBox flexCenter">
                <image src="https://saler.ishangbin.com/img/shareCard/titleLineLeft.png"
                    class="titleLine titleLineLeft">
                </image>
                <view class="rightTitle">权益升级规则</view>
                <image src="https://saler.ishangbin.com/img/shareCard/titleBgRight.png"
                    class="titleLine titleLineRight">
                </image>
            </view>
            <!-- 图表 -->
            <view class="containerCouponBox">
                <view class="containerCouponTitle">
                    <view class="main">卡折扣翻倍</view>
                    <view class="second">限名额好友参与，共建共享卡折扣</view>
                </view>
                <!-- 分销内容 -->
                <view class="chartBoxContainer flexCenter">
                    <view class="eachRules  myRule">
                        <view class="content flexCenter">
                            <view class="numTextBox">
                                <text class="">OFF</text>
                                <text class="present"> {{cardDesc.card.grows[0].value*10}}%</text>
                            </view>

                        </view>
                        <view class="desc">
                            <view class="title">主卡每次使用</view>
                            <view class="times">限{{cardDesc.card.grows[0].times}}次机会</view>
                        </view>
                    </view>
                    <view class="eachRules  frendRule">
                        <view class="content flexCenter">
                            <view class="numTextBox">
                                <text class="">OFF</text>
                                <text class="present"> {{cardDesc.card.grows[1].value*10}}%</text>
                            </view>
                        </view>
                        <view class="desc">
                            <view class="title">副卡首次使用</view>
                            <view class="times">限{{cardDesc.card.grows[1].times}}次机会</view>
                        </view>
                    </view>
                </view>
            </view>
        </view>
    </view>
    <!-- 商家详情 -->
    <view class="contentContainer">
        <div class="shopDetailBox">
            <view class="content">
                <view class="title">商家详情</view>
                <view class="innerText">
                    <rich-text type='text' wx:if="{{instructions}}" nodes="{{instructions}}"></rich-text>
                </view>
            </view>
        </div>
    </view>
    <!-- 活动说明 -->
    <view class="contentContainer">
        <view class="content">
            <view class="mainTitle"> 活动说明</view>
            <view class="descBox">
                <view class="innerText">
                    <rich-text type='text' wx:if="{{purchase}}" nodes="{{purchase}}"></rich-text>
                </view>
            </view>
        </view>
    </view>
    <!-- 适用门店 -->
    <view class="contentContainer">
        <view class="content shopContent">
            <view class="mainTitle">适用门店</view>
            <view class="shopsBox">
                <view wx:for="{{cardDesc.shops}}" wx:for-index='idx' wx:key="index">
                    <div class="eachShop flexSpace" wx:if="{{idx<showShopNum}}">
                        <view class="leftText" bindtap="makePhoneCall" data-phone="{{item.tel}}">
                            <view class="shopName">{{item.name}}</view>
                            <view class="address">{{item.address}}</view>
                        </view>
                        <view class="phone flexCenter" bindtap="makePhoneCall" data-phone="{{item.tel}}">
                            <image src="https://saler.ishangbin.com/img/shareCard/phone.png"></image>
                        </view>
                    </div>
                </view>
            </view>
            <view class="seeMoreShop flexCenter" wx:if="{{cardDesc.shops.length>2}}" bindtap="showAllShop">
                <view class="seeMoreShopText">{{showShopNum==2?'查看全部门店':'收起'}}</view>
                <image class="arrowDown {{showShopNum>2?'trans':''}}"
                    src="https://saler.ishangbin.com/img/shareCard/arrowDown.png"></image>
            </view>
        </view>
    </view>

</view>
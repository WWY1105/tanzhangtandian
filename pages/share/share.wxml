<view class='page' hidden="{{init}}">
<view hidden="{{init}}">
 <view class="first" style='background-image: url({{sharebg}})'>
  <view class="top">
    <view class="swiper">
      <swiper autoplay="true" interval="3000" circular="true" vertical="true">
        <block wx:for="{{swiper}}">
          <swiper-item>
            <image class="userimg" src='{{item.avatarUrl?item.avatarUrl:"../../img/userimg.png"}}'></image>
            <view class="username">{{item.nickname}}</view>
            <view class="useracount" >刚刚分得{{item.profits}}元</view>
          </swiper-item>
        </block>
      </swiper>
    </view>
    <view class="rulebtn" bindtap='toshopDetail'>商家详情</view>
  </view>

  <view class="pagetext" wx:if="{{posts.mode == '1002'}}">
    <view style="line-height:104rpx;">送好友超值优惠券</view>
    <view><text>{{posts.profitEstimation}}</text>元现金组团分</view>
  </view>
  <view class="pagetext" wx:if="{{posts.mode == '1000' || posts.mode == '1001'}}">
    <view style="line-height:104rpx;">送好友超值优惠券</view>
    <view>获<text>{{posts.profitEstimation}}</text>元现金奖励</view>
  </view>

  <view style="text-align: center;">
    <image src="../../img/grouptext.png" style="height: 190rpx;" wx:if="{{posts.mode == '1002'}}"></image>
    <image src="../../img/grouptext2.png" style="height: 190rpx;" wx:if="{{posts.mode == '1000' || posts.mode == '1001'}}"></image>
  </view>

  <view class="quan">
    <view class="group_quan">
      <image class="group_quan_bg" src="../../img/quanImg.png"></image>
      <view class="group_quan_content">
        <view class='group_quan_brand'>{{posts.shop.brandName}}</view>
        <view class="group_quan_left">
          <view class='group_quan_reduceLimit'>最高减</view>
          <view style='display:inline-block;font-weight: 500;'>{{posts.redEnvelopes[0].reduceLimit}}</view>
        </view>
        <view class='group_quan_right'>
          <view class='group_quan_amount'>每满{{posts.redEnvelopes[0].amount}}</view>
          <view class='group_quan_reduceAmount'>立减{{posts.redEnvelopes[0].reduceAmount}}</view>
        </view>
      </view>
    </view>
  </view>

  <view class="shareBox" wx:if="{{(posts.mode == '1000' || posts.mode == '1001') && posts.state == '1000' && posts.recipients == 0}}">
    <view class="shareBox_title">邀请好友领取超值优惠券</view>
    <view class="shareBox_text">——仅需门店{{posts.distanceLimit}}km内{{posts.recipientsLimit}}名好友领取即获{{posts.profitEstimation}}元现金!!——</view>
    <view class="timerBox">
      <view class="timertext">距赏金结束还有</view>
      <view class="timer">
        <text>{{posts.time.h}}</text> :
        <text>{{posts.time.m}}</text> :
        <text>{{posts.time.s}}</text>
      </view>
    </view>
    <!-- <button class="shareBtn" open-type="share">立即转发</button> -->
    <view class="shareBtn" bindtap='openModeBox'>立即转发</view>
    <view class='shareBox_bottom' bindtap='openrule'>活动规则</view>
  </view>

  <view class="shareBox" wx:if="{{posts.mode == '1002' && posts.state == '1000' && posts.recipients == 0}}" style="{{posts.obtainers?'top:612rpx;':''}}">
    <view class="shareBox_title">邀请好友组团瓜分现金</view>
    <view class="shareBox_text">——仅需门店{{posts.distanceLimit}}km内{{posts.recipientsLimit}}名好友组团即可瓜分{{posts.profitEstimation}}元现金——</view>
    <view class="timerBox">
      <view class="timertext">距瓜分结束还有</view>
      <view class="timer">
        <text>{{posts.time.h}}</text> :
        <text>{{posts.time.m}}</text> :
        <text>{{posts.time.s}}</text>
      </view>
    </view>
    <view class="shareuser" bindtap="toFriend" wx:if="{{posts.obtainers}}">
      <view class="oneuser" wx:for="{{posts.obtainers}}">
        <image src="{{item.avatarUrl?item.avatarUrl:'../../img/userimg.png'}}"></image>
      </view>
      <image class="rightimg" src="../../img/right.png"></image>
    </view>
    <!-- <button class="shareBtn" open-type="share">立即转发</button> -->
    <view class="shareBtn" bindtap='openModeBox'>立即转发</view>
    <view class='shareBox_bottom' bindtap='openrule'>活动规则</view>
  </view>

  <view class="shareBox" wx:if="{{posts.state == '1001'}}">
    <view class="stateTitle" wx:if="{{posts.mode == '1000' || posts.mode == '1001'}}">
      <image class="successImg1" src="../../img/shareone.png" mode="aspectFit"></image>
      <text>{{posts.salary}}</text>
      <image class="shareyuan" src="../../img/shareyuan.png" mode="aspectFit"></image>
    </view>
    <view class="stateTitle" wx:if="{{posts.mode == '1002'}}">
      <image class="successImg1" src="../../img/sharegroup.png" mode="aspectFit"></image>
      <text>{{posts.salary}}</text>
      <image class="shareyuan" src="../../img/shareyuan.png" mode="aspectFit"></image>
    </view>
    <view class="successText">共有{{posts.recipientsEffective}}人领取了优惠券</view>
    <view class="shareuser" bindtap="toFriend" style="height:75rpx;">
      <view class="oneuser" wx:for="{{posts.obtainers}}">
        <image src="{{item.avatarUrl?item.avatarUrl:'../../img/userimg.png'}}"></image>
        <view wx:if="{{posts.mode == '1002'}}">{{item.profits}}元</view>
      </view>
      <image class="rightimg" src="../../img/right.png"></image>
    </view>
    <view class="boxBottom">任务顺利完成</view>
  </view>

  <view class="shareBox" wx:if="{{posts.state == '1002' || posts.state == '1109' || posts.state == '1111'}}">
    <view class="stateTitle" style="background:#fff;" wx:if="{{posts.mode == '1000' || posts.mode == '1001'}}">
      <image class="successImg1" src="../../img/shareonefail.png" mode="aspectFit" style="width:600rpx;"></image>
    </view>
    <view class="stateTitle" style="background:#fff;" wx:if="{{posts.mode == '1002'}}">
      <image class="successImg1" src="../../img/sharefgroupfail.png" mode="aspectFit" style="width:600rpx;"></image>
    </view>
    <view class="successText">很可惜，只差{{posts.recipientsLimit-posts.recipientsEffective}}人</view>
    <view class="shareuser" bindtap="toFriend">
      <view class="oneuser" wx:for="{{posts.obtainers}}">
        <image src="{{item.avatarUrl?item.avatarUrl:'../../img/userimg.png'}}"></image>
      </view>
      <image class="rightimg" src="../../img/right.png"></image>
    </view>
    <view class="failbottom">下次请继续努力</view>
    <view class='shareBox_bottom' bindtap='openrule'>活动规则</view>
    <image class="failimg" src="../../img/faillog.png"></image>
  </view>

  <view class="shareBox" wx:if="{{posts.recipients>0 && posts.state == '1000'}}">
    <view class="stateTitle2">
      <text>共有{{posts.recipients}}人领取了优惠券</text>
      <view class="shareBox_left">
        <view class="shareBox_left_text">距赏金结束</view>
        <view class="shareBox_left_time">
          <text>{{posts.time.h}}</text> :
          <text>{{posts.time.m}}</text> :
          <text>{{posts.time.s}}</text>
        </view>
      </view>
      
    </view>
    <view class="shareBox_info">
      <view wx:if="{{posts.mode == '1000' || posts.mode == '1001'}}">已助力 <text>{{posts.recipientsEffective}}</text> 人</view>
      <view wx:if="{{posts.mode == '1002'}}">已参团 <text>{{posts.recipientsEffective}}</text> 人</view>
      <view class="shareBox_info_line"></view>
      <view>还差 <text>{{posts.recipientsLimit-posts.recipientsEffective}}</text> 人</view>
    </view>
    <view class="shareuser" bindtap="toFriend" style="height:75rpx;">
      <view class="oneuser" wx:for="{{posts.obtainers}}">
        <image src="{{item.avatarUrl?item.avatarUrl:'../../img/userimg.png'}}"></image>
      </view>
      <image class="rightimg" src="../../img/right.png"></image>
    </view>
    <view class="shareBtn" bindtap='openModeBox'>立即邀请</view>
    <view class='shareBox_bottom' bindtap='openrule'>活动规则</view>
  </view>




 </view>
  <view class='modalbox' wx:if="{{rulepop}}" catchtouchmove='true'>
    <view class='problembigbox'>
      <view class='problemtitile'>活动规则</view>
      <scroll-view class='problembox' scroll-y="true">
      
      <view class='content'>
        <view class='problem'>赏金任务怎么开启? 怎样才能获得赏金?</view>
        <view class='answer'>在活动商家消费后使用自助扫码买单，通过识别支付完成页面中“探长探店”小程序码进入小程序，视为成功参与活动。</view>
        <view class='answer'>在赏金有效时间内邀请好友领取门店福利，每邀请1名本地好友(门店{{posts.distanceLimit}}km内拆红包)成功拆开红包，即可算作一次有效助力，{{posts.recipientsLimit}}次有效助力即算完成任务获得赏金</view>
        <view class='answer'>注：非本地好友领取或者未授权地理位置信息的好友领取不算作有效助力，但仍然可以获赠门店福利</view>
      </view>
      <view class='content'>
        <view class='problem'>怎样才算本地好友?</view>
        <view class='answer'>在门店{{posts.distanceLimit}}km内成功拆开红包，即视为本地好友</view>
      </view>     
      <view class='content'>
        <view class='problem'>赏金怎么发放？为什么任务完成了还没有收到?</view>
        <view class='answer'>完成任务后，自动进入审核阶段，赏金会在2个工作日内自动发放到“微信钱包”，请留意服务通知，若未查询到赏金到账，请于下一个工作日10点之后查看</view>
      </view>
      
    </scroll-view>
    <button bindtap="closePop">我知道了</button>
    </view>
  </view>

  <view class='modalbox' wx:if="{{shopinfo}}" catchtouchmove='true'>
      
    
  </view>

  <view class="canvasBox" bindtap='picture' wx:if="{{canvasBox}}">
    <canvas canvas-id="shareCanvas" style="width:600px;height:1000px"></canvas>
  </view>

  <view class="groupmask" catchtouchmove="preventTouchMove" wx:if="{{groupBox}}">
    <view class="group">
      <view class="group_title">选择赏金的获取模式</view>
      <view class="group_box">
        <view class="group_select" data-mode="1000" >
          <image src="../../img/duxiang.png" mode='aspectFit'></image>
          <view>
            <view class="mode_title">自己拿</view>
            <view class="mode_content">好友为我助力</view>
            <view class="mode_content">赏金自己独享</view>
          </view>
          <form report-submit="true" bindsubmit='submittext'>
            <input type='text' value='1' style='display:none;'></input>
            <button class='modeBtn' data-mode="1001" form-type ='submit'></button>
          </form>
        </view>
        <view class="group_select" data-mode="1002" >
          <image src="../../img/guafen.png" mode='aspectFit'></image>
          <view>
            <view class="mode_title">大家分</view>
            <view class="mode_content">与{{posts.recipientsLimit}}名好友一起拼</view>
            <view class="mode_content">手气分赏金</view>
          </view>
          <form report-submit="true" bindsubmit='submittext'>
            <input type='text' value='1' style='display:none;'></input>
            <button class='modeBtn' data-mode="1002" form-type ='submit'></button>
          </form>
        </view>
      </view>
      <image class="group_close" src="../../img/close.png" mode='aspectFit' bindtap='close'></image>
    </view>
  </view>

  <view class='canvasimg' wx:if="{{canvamodel}}" catchtouchmove="preventTouchMove">
    <view class="showcanva">
      <image class='closeimg' wx:if="{{canva}}" src='../../img/close.png' bindtap='close'></image>
      <image class='canva' src='{{canva}}' mode='aspectFit'></image>
    </view>
    <view class='send'>
      <view>
        <form report-submit="true"  bindsubmit='submitformid'>
          <input type='text' value='1' style='display:none;'></input>
          <button   form-type ='submit' open-type="share" style='background-image: url({{weixin}})'></button>
        </form> 
        <view class='text'>分享给好友</view>
      </view>
      <view>
        <form report-submit="true"  bindsubmit='saveImg'>
          <input type='text' value='1' style='display:none;'></input>
          <button form-type ='submit' disabled='{{!canva}}'  style='background-image: url({{download}})'></button>
        </form>
        
        <view class='text' >保存并发送朋友圈</view>
      </view>
    </view>
  </view>
  <image class="hidden"  src="{{posts.sharePicUrl}}" wx:if="{{posts.sharePicUrl}}"></image>
  <view class='reward' style='background-image: url({{reward}})' bindtap="toHome"></view>
</view>
</view>